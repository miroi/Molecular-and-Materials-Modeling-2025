
Running SCF calculation...
  Total energy: -230.280074 eV

[Phase A.] Extracting charge density and Löwdin charges from SCF calculation...

1. Calculating charge density from SCF...
  pp.x completed successfully

2. Running projwfc.x on SCF...
  projwfc.x completed successfully

3. Extracting Löwdin charges from SCF (projwfc.out)...
  Löwdin charges saved to lowdin.out
  Spilling parameter: 0.008900 (values <0.05 are good)

Cleaning up SCF files and preparing for NSCF calculation...
  Moved all SCF-related files to scf_files directory

Running NSCF calculation for DOS with k-grid (30, 30, 30)...
  NSCF completed, wavefunctions generated for DOS

[Phase B.] Calculating DOS and PDOS from NSCF calculation...

4. Calculating TDOS from NSCF...
  dos.x completed successfully

5. Calculating PDOS from NSCF...
  projwfc.x completed successfully

6. Organizing PDOS files from NSCF...
  PDOS files moved to pdos_results directory

7. Verifying TDOS vs summed PDOS...
  Interpolating PDOS to TDOS grid...
  Max relative difference: 1.61%
  Excellent match (<5% difference)

=== Electronic Structure Analysis Complete ===
Generated files:
- Charge density (from SCF): charge_density.cube
- Löwdin Charges (from SCF): lowdin.out
- Total DOS (from NSCF): total_dos.dat
- PDOS files (from NSCF): pdos_results/
